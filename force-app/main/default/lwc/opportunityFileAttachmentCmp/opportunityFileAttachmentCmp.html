<!--
  @description       : 
  @author            : abhishek.gupta@continuserve.com
  @group             : 
  @last modified on  : 05-19-2023
  @last modified by  : abhishek.gupta@continuserve.com
-->
<template>
    <article class="slds-card">
        <div class="slds-card__header slds-grid">
        <header class="slds-media slds-media_center slds-has-flexi-truncate">
        <div class="slds-media__figure">
        <span class="slds-icon_container slds-icon-standard-account" title="account">
        <svg class="slds-icon slds-icon_small" aria-hidden="true">
        <use xlink:href="/assets/icons/standard-sprite/svg/symbols.svg#account"></use>
        </svg>
        <span class="slds-assistive-text">account</span>
        </span>
        </div>
        <div class="slds-media__body">
        <h2 class="slds-card__header-title">
        <a href="#" class="slds-card__header-link slds-truncate" title="Accounts">
        <span>File Handler</span>
        </a>
        </h2>
        </div>
        </header>
        </div>
        <div class="slds-card__body slds-card__body_inner">
            <template if:true={isLoading}>
                <div class="slds-spinner_container">
                  <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                </div>
              </template>
              <template if:false={isLoading}>
                <div>
                  <span><b>Total Open CIT Opportunities: {totalCITOppt}</b></span>
                  <br>
                  <span><b>Total Opportunities which have Quote Attachments: {totalOppt}</b></span>
                  <br>
                  <span><b>Total Quote Attachments: {totalFiles}</b></span>
                  <br>
                </div>
                <br>
                <button class="slds-button slds-button_brand" onclick={downLoadZipAttachment}>Download Zip</button>
                <button class="slds-button slds-button_brand" onclick={generateCsv}>Download Csv Report</button>

                <br>
                <br>
                <lightning-input type="file" label="Excel File" onchange={handleFileUpload}></lightning-input>

              </template>

            
        </div>
        </article>
</template>